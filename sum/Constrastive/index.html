
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://triplepiers.github.io/AQA/sum/Constrastive/">
      
      
        <link rel="prev" href="../Regression-Based/">
      
      
        <link rel="next" href="../Transformer/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Constrastive - Action Quality Assessment</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai Screen";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pair-wise" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Action Quality Assessment" class="md-header__button md-logo" aria-label="Action Quality Assessment" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Action Quality Assessment
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Constrastive
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Action Quality Assessment" class="md-nav__button md-logo" aria-label="Action Quality Assessment" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Action Quality Assessment
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Summary
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Summary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../survey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Survey
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Regression-Based/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Constrastive
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Constrastive
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2021-core" class="md-nav__link">
    <span class="md-ellipsis">
      2021: CoRe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2021: CoRe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-abstract" class="md-nav__link">
    <span class="md-ellipsis">
      1 Abstract
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-relative-works" class="md-nav__link">
    <span class="md-ellipsis">
      2 Relative Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-approach" class="md-nav__link">
    <span class="md-ellipsis">
      3 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-evaluation-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      4 Evaluation Protocol
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2022-tpt" class="md-nav__link">
    <span class="md-ellipsis">
      2022: TPT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2022: TPT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-abstract_1" class="md-nav__link">
    <span class="md-ellipsis">
      1 Abstract
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-approach" class="md-nav__link">
    <span class="md-ellipsis">
      2 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      3 Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2022-pcln" class="md-nav__link">
    <span class="md-ellipsis">
      2022: PCLN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2022: PCLN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1 Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-related-works" class="md-nav__link">
    <span class="md-ellipsis">
      2 Related Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-approach_1" class="md-nav__link">
    <span class="md-ellipsis">
      3 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      4 Evaluation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Self-Supervised/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Supervised
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GCN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GCN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Selekton-Based/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selekton-based
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segmentation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repitition
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FigureSkating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FigureSkating
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2018
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            2018
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2018%20Skeleton.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ST-GCN 基于骨骼的动作识别
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2021
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2021/CoRe.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CoRe 组感知对比回归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2021/TSA-Net.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSA-Net 管自注意力网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2021/Video-based.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Video-based
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2022
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            2022
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2022/TPA.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TPT 时序转译 transformer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            2023
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2023/PECoP.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PECoP 连续预训练
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2023/STPN.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FSPN 细粒度时空解析网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ref/2023/IRIS.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IRIS 评分标准可解释分割
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#2021-core" class="md-nav__link">
    <span class="md-ellipsis">
      2021: CoRe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2021: CoRe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-abstract" class="md-nav__link">
    <span class="md-ellipsis">
      1 Abstract
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-relative-works" class="md-nav__link">
    <span class="md-ellipsis">
      2 Relative Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-approach" class="md-nav__link">
    <span class="md-ellipsis">
      3 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-evaluation-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      4 Evaluation Protocol
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2022-tpt" class="md-nav__link">
    <span class="md-ellipsis">
      2022: TPT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2022: TPT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-abstract_1" class="md-nav__link">
    <span class="md-ellipsis">
      1 Abstract
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-approach" class="md-nav__link">
    <span class="md-ellipsis">
      2 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      3 Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2022-pcln" class="md-nav__link">
    <span class="md-ellipsis">
      2022: PCLN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2022: PCLN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1 Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-related-works" class="md-nav__link">
    <span class="md-ellipsis">
      2 Related Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-approach_1" class="md-nav__link">
    <span class="md-ellipsis">
      3 Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      4 Evaluation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="pair-wise">Pair-wise 对比学习</h1>
<h2 id="2021-core">2021: CoRe</h2>
<h3 id="1-abstract">1 Abstract</h3>
<div class="admonition info">
<p class="admonition-title">对比学习 Constrastive Learning</p>
<p>学习一个 representation space，通过比较两个（same class）样本在 representation space 中的距离来衡量其 语义联系 (semantic relationship)</p>
<blockquote>
<p>因为只有同组的才能直接对比，所以需要 Group-aware</p>
</blockquote>
<p>本文训练模型用于 <u>回归预测 relative score</u> 并对两个 video 的 score 进行对比，从而学习其 diff 用于最终分数估计</p>
</div>
<ul>
<li>
<p>现有工作：</p>
<p>从 single video 回归得到一个 quality score（针对单一视频的回归任务），面临三个挑战：</p>
<ol>
<li>
<p>Score Label 是由人类裁判给出的，其主观评判会给分数估计造成极大困难</p>
<p>suffter a lot from <u>large inter-video score variation</u></p>
</li>
<li>
<p>video 之间的差异是十分微小的：运动员往往在相似的环境下作出类似的动作</p>
</li>
<li>
<p>大多数解决方案使用 Spaerman's Rank 进行评估，这种方法可能不能正确反应评估表现</p>
</li>
</ol>
</li>
<li>
<p>创新点：</p>
<ul>
<li>
<p>基于 reference to another video that has shared attributes 进行分数预测（不是直接从单个视频下手）</p>
</li>
<li>
<p>提出了 CoRe：</p>
<p>通过 pare-wise comparision，强调视频之间的 <em>diff</em>，并引导模型学习评估的 key hint</p>
<div class="arithmatex">\[
    \text{Video} \rightarrow Model \rightarrow \text{Relative Score Space}
\]</div>
</li>
<li>
<p>通过 GART 将传统的分数回归预测划分为两个子问题：</p>
<blockquote>
<p>group-aware regression tree</p>
</blockquote>
<ol>
<li>
<p>coarse-to-fine classification: 判断 “好坏” 的二分类</p>
<p>将 relative score 空间划分成多个相离区间，随后通过二叉树将 relavtive score 划分到对应的 group</p>
</li>
<li>
<p>small interval regression</p>
<p><u>在 relative score 被预测的 class 内</u> 预测 final score</p>
</li>
</ol>
</li>
<li>
<p>提出 Relative L2-distance，在模型评估中考虑组间差异</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-relative-works">2 Relative Works</h3>
<ul>
<li>
<p>Gordan：使用骨架轨迹评估体操跳跃动作质量</p>
</li>
<li>
<p>Pirsiavash：</p>
<ul>
<li>
<p>离散余弦变换（DCT）被用于从 body pose 图像到 input feature 的编码</p>
</li>
<li>
<p>SVR 被用于从 feature 到 final score 的映射</p>
</li>
</ul>
</li>
<li>
<p>Parmar：使用 C3D 对视频数据进行编码以获得 spatio-temporal features</p>
</li>
<li>
<p>Xu：使用两个 LSTM 来学习 multi-scale feature</p>
</li>
<li>
<p>Pan：</p>
<ul>
<li>
<p>使用 spatial &amp; temporal relation graphs，在其相交处建模（？）</p>
</li>
<li>
<p>使用 I3D 提取 spatio-temporal features</p>
</li>
</ul>
</li>
<li>
<p>Tang：提出 USDL 来降低人类裁判打分造成的歧义</p>
<blockquote>
<p>uncertainty-aware score distribution learning</p>
</blockquote>
</li>
</ul>
<h3 id="3-approach">3 Approach</h3>
<p><img alt="" src="../../assets/CoRe%20Pipline.png" /></p>
<h4 id="1-contrastive-regression">1 Contrastive Regression</h4>
<ul>
<li>
<p>Problem Formulation</p>
<ul>
<li>
<p>大多数方法将 AQA 视为一个回归问题：输入包含目标动作的 video，输出对应的 quality score</p>
</li>
<li>
<p>部分方法提出了 difficulty-score（已知），最终结果变为 qulity * difficulty</p>
</li>
</ul>
<div class="admonition bug">
<p class="admonition-title">由于视频往往在相似的环境下拍摄，模型很难从微小的变化中学习巨大的分数差异</p>
</div>
<hr />
<ul>
<li>
<p>重新定义问题为：</p>
<p>Regress relative score between the Input Video <span class="arithmatex">\(v_m=\{F_m^i\}_{i=1}^{L_m}\)</span> &amp; an Exemplar <span class="arithmatex">\(v_n=\{F_n^i\}_{i=1}^{L_n}\)</span> with Score Label <span class="arithmatex">\(s_n\)</span></p>
</li>
<li>
<p>我们可以将回归问题写为如下形式：</p>
<div class="arithmatex">\[
\hat{s}_m = R_{\Theta}(F_W(v_m), F_W(v_n)) + s_n
\]</div>
<p><center>其中 <span class="arithmatex">\(R_{\Theta}\)</span> 为回归模型，<span class="arithmatex">\(F_W\)</span> 为特征提取模型（参数相同的I3D）</center></p>
<blockquote>
<p>计算 CurInput &amp; Exampler 之间的偏差值，然后基于 Exampler 的分数进行生成评分</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Exemplar-Based Score Regression</p>
<div class="admonition question">
<p class="admonition-title">如何挑选具有可比性的 Exampler</p>
</div>
<ol>
<li>
<p>使用 I3D 模型对 input &amp; exampler 进行特征提取，得到 <span class="arithmatex">\(f_m, f_n\)</span></p>
</li>
<li>
<p>将两者特征与 exampler score 进行聚合：<span class="arithmatex">\(f_{(n,m)} = concat([f_n, f_m, \frac{s_n}{\epsilon}])\)</span></p>
<p><span class="arithmatex">\(\epsilon\)</span> 是一个 norm constant，用于确保 <span class="arithmatex">\(\frac{s_n}{\epsilon} \in [0,1]\)</span></p>
</li>
<li>
<p>使用回归模型对 <span class="arithmatex">\(pair(n,m)\)</span> 的 score-diff 进行预测：<span class="arithmatex">\(\Delta s = R_{\Theta}(f_{(n,m)})\)</span></p>
</li>
</ol>
</li>
</ul>
<h4 id="2-group-aware-regression-tree">2 Group-Aware Regression Tree</h4>
<ul>
<li>
<p>contrastive regression 存在的问题</p>
<p>比较回归可以预测 relative score <span class="arithmatex">\(\Delta s\)</span>，但通常具有较大的值域</p>
<p>=&gt; 直接预测 <span class="arithmatex">\(\Delta s\)</span> 具有一定困难</p>
</li>
<li>
<p>GART 实现分治</p>
<ol>
<li>
<p>将 <span class="arithmatex">\(\Delta s\)</span> 的值域划分为 2<sup>d</sup> 个 non-overlapping class</p>
</li>
<li>
<p>建立 <span class="arithmatex">\(d-1\)</span> 层的 二叉回归树（有 2<sup>d</sup> 个 leaf nodes）</p>
</li>
<li>
<p>分类</p>
<p>整个过程遵循 coarse-to-fine manner：第一层决定 input 比 exampler 好/坏，并在后续具体量化 better/worse 的程度</p>
</li>
</ol>
</li>
<li>
<p>Tree Architecture</p>
<ul>
<li>
<p>Input：</p>
<ul>
<li>
<p>Root Node: 将聚合特征 <span class="arithmatex">\(f_{(n,m)}\)</span> 放进多层神经网络 MLP，并将 <span class="arithmatex">\(\text{MLP}(f_{(n,m)})\)</span> 作为 GART 的输入</p>
</li>
<li>
<p>Other Nodes: 父节点的输出</p>
</li>
</ul>
</li>
<li>
<p>Output:</p>
<ul>
<li>
<p>Internal Nodes: 产生通向左右子节点的概率</p>
<p>通向某个具体 leaf node 的概率 = <span class="arithmatex">\(\prod p_{\text{nodes in path}}\)</span></p>
</li>
<li>
<p>Leaf Nodes: <span class="arithmatex">\(sigmoid(P_{\text{leaf}}) \in [0,1]\)</span> 代表了 Input 和对应 class 的 score-diff</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>边界划分策略</p>
<blockquote>
<p>等长划分 class 会导致 unbalance</p>
</blockquote>
<ol>
<li>
<p>收集测试集中所有 pair 的 score-diff： <span class="arithmatex">\(\delta = [\delta_1, ... ,\delta_T]\)</span>，对其进行升序排列后得到 <span class="arithmatex">\(\delta^*\)</span></p>
</li>
<li>
<p>给定 n_class = <span class="arithmatex">\(R\)</span>，遵循以下策略得到各组边界 <span class="arithmatex">\(G^r = (min^r, max^r)\)</span>:</p>
<div class="arithmatex">\[
\begin{align*}
    min^r &amp;= \delta^*\left[\lfloor(T-1) \times \frac{r-1}{R}\rfloor\right] \\
    max^r &amp;= \delta^*\left[\lfloor(T-1) \times \frac{r}{R}\rfloor\right]
\end{align*}
\]</div>
<p><center>其中，<span class="arithmatex">\(\delta^*[i]\)</span> 表示数组中的第 i 个元素</center></p>
</li>
</ol>
</li>
<li>
<p>优化策略</p>
<blockquote>
<p>GART 包含 classification &amp; in-class regression，所以总的 Cost 要拆成两部分。</p>
</blockquote>
<p>当 pair <span class="arithmatex">\(\delta\)</span> 的 score-diff 被分类至 Class i 时:</p>
<ul>
<li>
<p>将 One-Hot 分类标签的对应位置置 1: <span class="arithmatex">\(l[i] = 1\)</span> </p>
</li>
<li>
<p>另 regression 标签 <span class="arithmatex">\(\sigma_i = \frac{\delta - min^i}{max^i - min^i}\)</span></p>
</li>
</ul>
<p>此时，每个 pair 都拥有 One-Hot Classification Label <span class="arithmatex">\(l\)</span> &amp; Regression Label <span class="arithmatex">\(\sigma\)</span>:</p>
<div class="arithmatex">\[
\begin{align*}
J_{cls} &amp;= - \sum_{r=1}^{R}(l_r \log(P_r) + (1 - l_r)\log(1-P_r))\\
J_{reg} &amp;= \sum_{r=0}^R(\hat{\sigma}_r - \sigma_r)^2, \text{where } l_r=1\\
J &amp;= J_{cls} + J_{reg}
\end{align*}
\]</div>
<p><center>其中 <span class="arithmatex">\(P_r, \hat{\sigma}_r\)</span> 分别是 Leaf Probability &amp; Regression Result</center></p>
</li>
<li>
<p>前向推导（仅 GART 部分）</p>
<div class="arithmatex">\[
R_{\Theta}(f_{(n,m)}) = \hat{\sigma}_{r^*} (max^{r^*}-min^{r^*}) + min^{r^*}
\]</div>
<p><center><span class="arithmatex">\(r^*\)</span> 是具有 Max Probability 的 class 编号</center></p>
<div class="admonition info">
<p class="admonition-title">Multi-Exampler Voting Strategy</p>
<p>对于给定输入 <span class="arithmatex">\(v_{\text{test}}\)</span>，选定 <span class="arithmatex">\(M\)</span> 个 exampler <span class="arithmatex">\(\{v^m_{\text{train}}\}_{m=1}^M\)</span> 及其对应分数标签 <span class="arithmatex">\(\{s^m_{\text{train}}\}_{m=1}^M\)</span></p>
<p>Voting 策略可以使用如下公式进行描述：</p>
<div class="arithmatex">\[
    \begin{align*}
        \hat{s}^m_{\text{test}} &amp;= R_{\Theta}(F_W(v_{\text{test}}, v_{\text{train}}^m)) + s_{\text{train}}^m \\
        \hat{s}_{\text{test}} &amp;= \frac{1}{M} \sum \hat{s}_{\text{test}}^m
    \end{align*}
\]</div>
</div>
</li>
</ul>
<h3 id="4-evaluation-protocol">4 Evaluation Protocol</h3>
<ol>
<li>
<p>Spearman's Rank Correlation </p>
<p>为了能和之前的工作进行比较，此处采用了 Spearman's Rank Correlation 作为评估标准：</p>
<div class="arithmatex">\[
\rho = \frac{\sum(p_i-p)(q_i-q)}{\sqrt{\sum(p_i-\overline{p})^2 \sum(q_i-\overline{q})^2}}
\]</div>
<p>其中 <span class="arithmatex">\(p,q\)</span> 分别表示样本在两个序列中的 ranking</p>
</li>
<li>
<p>Fisher’s z-value</p>
<p>用于评估 across-action 的平均表现</p>
</li>
<li>
<p>Relative L2-Distance</p>
<p>对于特定动作的 max/min score，R-l<sub>2</sub> 遵循如下定义：</p>
<div class="arithmatex">\[
R-l_2(\theta) = \frac{1}{K} \sum\left(\frac{|s_k - \hat{s}_k|}{s_{max} - s_{min}}\right)^2
\]</div>
<p>其中 <span class="arithmatex">\(s_k,\hat{s}_k\)</span> 分别表示第 k 个样本的 ground-truth 和 预测得分</p>
<blockquote>
<p>传统的 l<sub>2</sub> 距离对于从属于不同 class 的 action 是无意义的；</p>
<p>相比于 Spearman's Rank Correlation 注重 RANK，R-l<sub>2</sub> 更加重视具体数值</p>
</blockquote>
</li>
</ol>
<h2 id="2022-tpt">2022: TPT</h2>
<h3 id="1-abstract_1">1 Abstract</h3>
<ul>
<li>
<p>先前的 SOTA 方法</p>
<p>使用 ranking-based pairwise comparison，或 regression-based methods </p>
<p>=&gt; 通过对 backbone 输出做 global Pooling，基于 <em>整个视频 (holistic video)</em> 进行 regression / ranking</p>
<div class="admonition bug">
<p class="admonition-title">限制了对 细粒度·类内差异 (fine-grained intra-class variation) 的捕捉</p>
</div>
</li>
<li>
<p>创新点</p>
<p>regression-based，可以在避免 part-level 监督的情况下学习更细粒度的特征</p>
<ol>
<li>
<p>使用 Temporal Parsing Transfomer 将 "整体特征(holistic)" 拆解为 temporal part-level 形式</p>
<div class="admonition example">
<p class="admonition-title">将 Diving 拆解为 approach -&gt; take off -&gt; flight 等多个阶段</p>
</div>
<ul>
<li>
<p>使用一系列 queries 来表示 <u>特定动作的 atomic temporal patterns</u></p>
</li>
<li>
<p>在 Decoding 阶段，将 frames 转换为 长度固定的·按照时序排列的 part representations</p>
</li>
<li>
<p>基于 (relative pairwise) part representations 和 对比回归 得到最终的 Quality Score</p>
</li>
</ul>
</li>
<li>
<p>提出了两种新的 Loss Function 用于 Decoder</p>
<blockquote>
<p>因为当前的数据集都没有提供 temporal part-level labels / partitions</p>
</blockquote>
<ol>
<li>
<p>Ranking Loss: Cross Attenion 阶段学习的参数符合时序</p>
</li>
<li>
<p>Sparsity Loss: 让学习的 part representation 更具 "判别性(discriminative)"</p>
</li>
</ol>
</li>
</ol>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Temporal Action Parsing: 细粒度动作识别</p>
<ul>
<li>Zhang: Temporal Query Network adopted query-response functionality</li>
<li>Dian: TransParser</li>
</ul>
<p>上述工作均聚焦于 "frame-level" 的特征增强，而本文则侧重于提取 "更具备语义信息的·part representation"</p>
</div>
<h3 id="2-approach">2 Approach</h3>
<p><img alt="" src="../../assets/TPT%20Pipeline.png" /></p>
<h4 id="overview">Overview</h4>
<ol>
<li>
<p>使用滑动窗口将 input 划分为 <span class="arithmatex">\(T \times M \text{frames}\)</span> 的 <u>重叠 Clips</u></p>
</li>
<li>
<p>对于分割得到的 Clips，使用 I3D (backbone) 处理得到 <span class="arithmatex">\(V = \{v_t \in \mathbb{R}^D\}_{t=1}^T\)</span></p>
<ul>
<li>
<p><span class="arithmatex">\(D\)</span> 为 feature dimension</p>
</li>
<li>
<p>每个 <span class="arithmatex">\(v_t\)</span> 经由空间上的 Average Pooling 得到（本模型并不关注 spatial patterns）</p>
</li>
</ul>
</li>
<li>
<p>Contrastive Regression</p>
<ol>
<li>
<p><u>Clip-Level</u> <span class="arithmatex">\(V\)</span> <span class="arithmatex">\(\rightarrow\)</span> <u>Temporal Part-Level</u> representations <span class="arithmatex">\(P =\{p_k\in \mathbb{R}^d\}_{k=1}^K\)</span></p>
<blockquote>
<p><span class="arithmatex">\(d\)</span> 为 Part Feature-dimension, <span class="arithmatex">\(K\)</span> 为 query 总数</p>
<p>操作分别对 Input &amp; Exampler 进行，生成 <span class="arithmatex">\(P, P_0\)</span></p>
</blockquote>
</li>
<li>
<p>基于 Part-aware Contrastive Regressor 计算 Part-wise Relative representations</p>
</li>
<li>Fuse Part-aware representation 以预测 Relative Score <span class="arithmatex">\(\Delta s = R(P,P_0)\)</span></li>
<li>Final Score = <span class="arithmatex">\(s + \Delta s\)</span>（<span class="arithmatex">\(s\)</span> 为 exampler 的实际分数）</li>
</ol>
</li>
</ol>
<h4 id="temporal-parsing-transformer">Temporal Parsing Transformer</h4>
<blockquote>
<p>输入：Clip-Level Representation <span class="arithmatex">\(V\)</span>，输出：quries (Part Representation)</p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">区别于 DETR 的 Transformer 架构</p>
<ol>
<li>
<p>因为 Encoder 不能提高本方法的准确性，本方法 <strong>仅包含 Decoder</strong>：</p>
<p>可能是因为：</p>
<ul>
<li>
<p>clip-level self-attention smooths the temporal representations</p>
</li>
<li>
<p>本方法 cannot decode part presentations without part labels</p>
</li>
</ul>
</li>
<li>
<p>在 cross attention block 添加了参数 <span class="arithmatex">\(temperature\)</span> 以控制内积的放大（？）</p>
</li>
<li>
<p>没有把位置信息（clip id）embed 到输入数据中</p>
<p>=&gt; query 用于表示 atomic patterns 而非作为时间锚点</p>
</li>
</ol>
</div>
<p>对于 <span class="arithmatex">\(i^{th}\)</span> Decoder Layer，有：</p>
<ul>
<li>
<p>Decoder Part Feature <span class="arithmatex">\(p^{(i)}_k \in \mathbb{R}^d\)</span></p>
</li>
<li>
<p>Learnable Atomic Patterns <span class="arithmatex">\(q_k \in \mathbb{R}^d\)</span></p>
</li>
<li>
<p>embedded Clip Rrpresentation <span class="arithmatex">\(v_t \in \mathbb{R}^d\)</span></p>
</li>
</ul>
<p><center>先用 <span class="arithmatex">\(p^{(i)}_k + q_k\)</span> 得到 query，随后和 <span class="arithmatex">\(v_t\)</span> 做 cross attention 得到输出 <span class="arithmatex">\(\alpha_{k,t}\)</span></center></p>
<div class="arithmatex">\[
\alpha_{k,t} = \frac{
    \exp{((p_k^{(i)} + q_k)^T \cdot \frac{v_t}{\tau})}
}{
    \sum_{j=1}^T \exp{((p_k^{(i)} + q_k)^T \cdot \frac{v_j}{\tau})}
}
\]</div>
<ul>
<li><span class="arithmatex">\(\alpha_{k,t}\)</span> 表示 query<sup>k</sup> 和 clip<sup>t</sup> 之间的 attention value</li>
<li><span class="arithmatex">\(\tau \in \mathbb{R}\)</span> 是可调参数，用于放大内积以使得 attention 更加 discriminative.</li>
</ul>
<hr />
<p>由于本模块的目的在于：将 Clip Repre 聚合到 Part Repre 中，我们需要根据如下策略对 Part Repre 进行更新：</p>
<div class="arithmatex">\[
p^{(i)}_k += \sum_{j=1}^{T} \alpha_{k,j} v_j + p_k^{(i)}
\]</div>
<h4 id="part-aware-contrastive-regression">Part-Aware Contrastive Regression</h4>
<blockquote>
<p>在 Temporal Parsing Transformer 模块，我们已经成功将输入转化为 Part Repre <span class="arithmatex">\(P = \{p_k\}\)</span>;</p>
<p>此时我们需要对 Input 和 Exampler 的 <span class="arithmatex">\(P,P_0\)</span> 进行比较，并生成 Relative Score <span class="arithmatex">\(\Delta s\)</span></p>
</blockquote>
<div class="admonition tip">
<p class="admonition-title">我们可以分别计算每个 Part 的相对分数，最后把他们 fuse 到一块儿</p>
</div>
<p>对于 <span class="arithmatex">\(k^{th}\)</span> Part，我们通过 <em>多层感知机(MLP)</em> <span class="arithmatex">\(f_r(.)\)</span> 生成对应的 relative pairwise representation <span class="arithmatex">\(r_k \in \mathbb{R}^d\)</span>：</p>
<blockquote>
<p>所有的 Parts <u>共用一个 MLP</u></p>
</blockquote>
<div class="arithmatex">\[
r_k = f_r(\text{concat}([P_k;P_k^0]))
\]</div>
<hr />
<p>为了提高准确性，此处使用 Group-aware Regression strategy 生成 Relative Score <span class="arithmatex">\(\Delta s\)</span>：</p>
<ul>
<li>
<p>对 Training Set 中所有可能的 pair 生成 <span class="arithmatex">\(B\)</span> 个 <span class="arithmatex">\(\Delta s\)</span> 取值区间（类似 CoRe Tree 里的区间非偏区间划分策略）</p>
</li>
<li>
<p>生成 One-Hot Label <span class="arithmatex">\(\{l_n\}\)</span>，表示 <span class="arithmatex">\(\Delta s[i]\)</span> 所处的区间编号</p>
</li>
</ul>
<hr />
<p>对 Input Video 的预测：</p>
<ol>
<li>对 Relative Part Repre <span class="arithmatex">\(\{r_k\}\)</span> 使用 Average Pooling</li>
<li>使用 2 * 2-Layer MLP 对输入视频的 classification label <span class="arithmatex">\(l\)</span> &amp; 回归结果 <span class="arithmatex">\(\gamma\)</span> 进行预测</li>
</ol>
<h3 id="3-optimization">3 Optimization</h3>
<ul>
<li>
<p>假设：每一类动作都可以按照相同顺序进行阶段切分，并通过 transformer query 进行表示</p>
</li>
<li>
<p>在 Cross Attention 阶段，<span class="arithmatex">\(k^{th}\)</span> query 的 attention center <span class="arithmatex">\(\\overline{\alpha}_k\)</span>：</p>
<div class="arithmatex">\[
\overline{\alpha}_k = \sum_{t=1}^T t \cdot \alpha_{k,t} \in [1,T]
\]</div>
<ul>
<li><span class="arithmatex">\(\{\alpha_{k,t}\}\)</span> 是已经 normalized 的 attention responses</li>
<li><span class="arithmatex">\(k^{th}\)</span> query 对于所有 clip 的 attention 总和为 1，即 <span class="arithmatex">\(\sum_{t=1}^T \alpha_{k,t} = 1\)</span></li>
</ul>
</li>
</ul>
<h4 id="cross-attention-block">Cross Attention Block</h4>
<ol>
<li>
<p>Ranking Loss</p>
<p>为了鼓励各 query 聚焦于 <u>different temporal region</u>，我们对 attention center 使用 Ranking Loss</p>
<div class="admonition tip">
<p class="admonition-title">理想情况下，Part Repre 在（同类）不同视频下有 <u>相同时序</u></p>
</div>
<div class="arithmatex">\[
L_{rank} = \sum_{k=1}^{K-1} \max{(0,\ \overline{\alpha}_k - \overline{\alpha}_{k+1} + m)} + \max{(0,\ 1-\overline{\alpha}_1 + m)} + \max{(0,\ \overline{\alpha}_k - T + m)}
\]</div>
<p><center><span class="arithmatex">\(m\)</span> 是用于控制惩罚力度的超参数</center></p>
<ul>
<li>
<p>第一项用于确保顺序 <span class="arithmatex">\(\overline{\alpha}_k \lt \overline{\alpha}_{k+1}\)</span> 成立</p>
</li>
<li>
<p>后两项分别用于确定首位顺序 <span class="arithmatex">\(\overline{\alpha}_0 = 1\)</span> 和 <span class="arithmatex">\(\overline{\alpha}_{k+1} = T\)</span> 成立
（<span class="arithmatex">\(\overline{\alpha}_k \in [1,T]\)</span>）</p>
</li>
</ul>
</li>
<li>
<p>Sparsity Loss</p>
<p>鼓励每一个 query 聚焦于靠近 center <span class="arithmatex">\(\mu_k\)</span> 的那些切片：</p>
<div class="arithmatex">\[
L_{sparsity} = \sum_{k=1}^K\sum_{t=1}^T|t - \overline{\alpha}_k| \cdot \alpha_{k,t}
\]</div>
</li>
</ol>
<h4 id="contrastive-regressor">Contrastive Regressor</h4>
<p>基于比较学习的回归器需要预测 分组标签 <span class="arithmatex">\(l\)</span> &amp; 相对偏差 <span class="arithmatex">\(\gamma\)</span>，我们：</p>
<ul>
<li>
<p>对各组使用 BCE Loss</p>
<div class="arithmatex">\[
L_{cls} = - \sum_{n=1}^N [l_n \log{(\vec{l}_n)} + (1-l_n) \log{(1 - \vec{l}_n)}]
\]</div>
</li>
<li>
<p>对由 ground-truth 生成的 interval 信息使用 Square Error</p>
<div class="arithmatex">\[
L_{reg} = \sum_{n=1}^N (\gamma_n \ \vec{\gamma}_n)^2, \text{ where } l_n=1
\]</div>
</li>
</ul>
<h4 id="overall-training-loss">Overall Training Loss</h4>
<div class="arithmatex">\[
L = \lambda_{cls} L_{cls} + \lambda_{reg} L_{reg} + \lambda_{rank} \sum_{i=1}^L L^i_{rank} + \lambda_{sparsity} \sum_{i=1}^L L^i_{sparsity}
\]</div>
<h2 id="2022-pcln">2022: PCLN</h2>
<blockquote>
<p>Pairwise Contrastive Learning Network</p>
</blockquote>
<details class="info">
<summary>End-to-End 模型</summary>
<p>指直接输入 <em>原始数据(raw data)</em>，输出最终结果的模型</p>
<ul>
<li>
<p>经典的 Machine Learning 方法</p>
<ul>
<li>
<p>需要人工进行 feature engineering，通过先验经验人工的将 raw data 处理成 feature，随后输入模型</p>
</li>
<li>
<p>在这种情况下，特征提取的好坏会严重影响预测质量（甚至比学习算法本身造成的影响更大）</p>
</li>
<li>
<p>此时的 ML 方法由多个 <em>独立模块</em> 执行，比如 NLP = 分词 + 词性标注 + 词法分析 + 语义分析 ...</p>
</li>
</ul>
</li>
<li>
<p>多层神经网络</p>
<ul>
<li>
<p>可以拟合<strong>任意非线性函数</strong>，模型可以自行通过反向传输对 feature 进行捕捉</p>
</li>
<li>
<p>这使得 End-to-End 模型中间的细节都无需人工干预（丢图片进去就行了）</p>
</li>
</ul>
</li>
</ul>
</details>
<h3 id="1-introduction">1 Introduction</h3>
<ul>
<li>
<p>Previous Works: AQA in sports</p>
<ul>
<li>
<p>common solution: <span class="arithmatex">\(\text{Regression}(\text{video}) \rightarrow \text{Score}\)</span></p>
<p>=&gt; 忽略了 subtle diffs，也没有考虑同分但不同难度的情况</p>
</li>
<li>
<p>一种启发式的解决方案：train a specific model to learn diffs <em>between videos</em></p>
<p>受 pairwise Learning to Rank (LTR) 思想的启发（一对对比较数据，然后排名）</p>
<ul>
<li>以 video-pairs 为输入（可以扩大训练集 <span class="arithmatex">\(N \rightarrow C_N^2\)</span>）</li>
<li>以相对分数 relative score = <code>s1 - s2</code> 作为标签（预测目标）</li>
</ul>
</li>
</ul>
</li>
<li>
<p>本文工作</p>
<ul>
<li>
<p>提出了 BasicRegression + PCLN 的端到端模型，对 Video-Pair 进行编码，对 relative score 进行预测</p>
<p>PCLN 是一个新颖的、LTR-based 模型，用于学习两个视频间的差异</p>
</li>
<li>
<p>定义了新的 consistency constraint 用于训练模型（平衡 PCLN &amp; BasicRgression）</p>
</li>
<li>
<p>在 Test 阶段，只有 BasicRegression 模块参与（PCLN 不用动）</p>
</li>
<li>
<p>benchmarks: AQA-7, MTL-AQA</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-related-works">2 Related Works</h3>
<h4 id="a-regression-based-aqa">a) Regression-based AQA</h4>
<p>基于 input data 的格式可以被分为两类：</p>
<ol>
<li>
<p>Skeleton-based</p>
<ul>
<li>Pirsiavash：DCT（特征提取）+ SVR（回归预测）</li>
<li>Pan：<code>Human joint Learning = joint-Common + joint-Difference</code> Modules</li>
</ul>
</li>
<li>
<p>Appearance-based</p>
<blockquote>
<p>to: acquire more detailed appearance-based info</p>
</blockquote>
<ul>
<li>Parmar: C3D（特征提取）+ SVR &amp; LSTM（回归预测）</li>
<li>Xiang: P3D（分段特征提取）+ fuse（整合） + Regression（回归预测）</li>
<li>Tang: Uncertainty-aware Score Distribution Learning</li>
<li>Dong: (Multioke Hidden Substages) Learning &amp; Fusion Network</li>
</ul>
</li>
</ol>
<h4 id="b-pairwise-ranking-aqa">b) Pairwise Ranking AQA</h4>
<ul>
<li>
<p>Doughty: A Supervised Deep Ranking Method</p>
<p>a rank-specific attention Module，用于分别处理 higher/lower skills parts</p>
</li>
<li>
<p>Yu: Group-aware Regression Tree（替换传统 Regression 模块）</p>
</li>
<li>
<p>Jain: 使用 Binary Classification Network 来学习两个视频间的 <strong>similarity</strong></p>
<p>将 input video &amp; expert video(训练集中得分最高的) 被一起输入模型，但是：</p>
<ul>
<li>只有一个 expert sample 不能适应动作的复杂性和视频的多样性</li>
<li>使用了 2-stage 策略，不能保证在 Binary-Classification 阶段学习的参数同样适用于 Score-Regression 阶段</li>
</ul>
</li>
</ul>
<h3 id="3-approach_1">3 Approach</h3>
<p><center>
    <img src="../../assets/PCLN-Pipeline.png" style="max-height:250px;">
</center></p>
<h4 id="question-formulation">Question Formulation</h4>
<ul>
<li>
<p>Input: </p>
<ul>
<li>
<p>假设输入的视频共有 <span class="arithmatex">\(L\)</span> 帧，则可将输入视频记为 <span class="arithmatex">\(V = \{v_i\}_{i=1}^L\)</span></p>
</li>
<li>
<p>PCLN 用于学习两个视频之间的 diff，从而进行更准确的预测。其输入 <span class="arithmatex">\(&lt;V_i, V_j&gt;\)</span> 有随机抽样产生，共有 <span class="arithmatex">\(C(n,2)\)</span> 种</p>
</li>
</ul>
</li>
<li>
<p>Prediction: 使用 <span class="arithmatex">\(\Theta(·)\)</span> 表示分数预测函数，则整个模型的功能可以概括为</p>
<div class="arithmatex">\[
\hat{S} = \Theta(V)
\]</div>
<p>但必不可能这么简单，本文的目的就是找到一个更有效的 Regression Function <span class="arithmatex">\(\Theta(·)\)</span></p>
<blockquote>
<p>最抽象的是：这个方法里 <span class="arithmatex">\(\hat{S}\)</span> 和 <span class="arithmatex">\(\Delta S\)</span> 是由 BasicReg 和 PCLN 模块 <strong>独立预测</strong> 的</p>
</blockquote>
<p>将本文提出的算法记为 <span class="arithmatex">\(\Upsilon(·)\)</span>，那么整体过程可以重写为：</p>
<div class="arithmatex">\[
[\hat{S}_i, \hat{S}_j, \Delta S] = \Upsilon(V_i, V_j)
\]</div>
</li>
</ul>
<h4 id="feature-extraction">Feature Extraction</h4>
<p>对于 video-pair <span class="arithmatex">\(&lt;V_i, V_j&gt;\)</span>，理论上有两种特征提取方案：</p>
<ol>
<li>
<p>3D-Conv-based: require short clip with fixed-length</p>
<div class="admonition bug">
<p class="admonition-title">从 clip 中提取的特征并不稳定，会导致预测结果存在较大波动</p>
</div>
</li>
<li>
<p>✅ Temporal Encoder-based</p>
</li>
</ol>
<hr />
<p>本文使用的 Temporal Encoder-based 方法：</p>
<div class="arithmatex">\[
f_i = \text{TemporalEncoder}(\text{ResNet}(V_i)),\ i=p,q
\]</div>
<p><center><span style="color:grey;">对视频 <span class="arithmatex">\(V_i,V_j\)</span> 使用 weight-sharing Model 分别提取特征</span></center></p>
<ol>
<li>使用 backbone（ResNet） 对 each frame 进行特征提取</li>
<li>
<p>使用 Temporal Encoder Network 对 featureSeq 的时序信息进行编码</p>
<ul>
<li>Temporal Encoder Network 由两个 EncodingBlock 堆叠而成。</li>
<li>单个 EncodingBlock = <code>1*1</code> temporalConv + ActivationFunc + maxPooling</li>
</ul>
</li>
</ol>
<h4 id="score-regression">Score Regression</h4>
<ul>
<li>
<p>使用 Fully-Connexted Network 进行回归运算</p>
<p>该 FC network 共包含三个全连接层：<code>D * 4096</code>, <code>4096 * 2048</code>, <code>2048 * 1</code></p>
</li>
<li>
<p>我们可以用以下的公式描述 Regression 过程：</p>
<div class="arithmatex">\[
\hat{S}_i = \text{Regression}(f_i),\ i=p,q
\]</div>
</li>
</ul>
<h4 id="pcln-model">PCLN Model</h4>
<blockquote>
<p>大多数体育活动是在 similar background 下完成的</p>
</blockquote>
<p><center>
    <img src="../../assets/PCLN.png">
</center>
<center>
    <span style="color:grey;">使用 Teomporal-Encoded Features <span class="arithmatex">\(f_p, f_q\)</span> 作为输入</span>
</center></p>
<ol>
<li>
<p>对于单个输入视频（的 temporal encoded feature）使用 1D-Conv</p>
<blockquote>
<p>further encode feature 以捕捉抽象程度更高的 action info</p>
</blockquote>
<div class="arithmatex">\[
f'_i = \text{ReLU}(w_{(0)} \otimes f_i + b_{(0)}),\ i=p,q
\]</div>
<p><span class="arithmatex">\(w_{(0)}\)</span> 是 1D-Conv 参数，<span class="arithmatex">\(\otimes\)</span> 是 Conv 操作，<span class="arithmatex">\(b_{(0)}\)</span> 是对应的 bias vec</p>
</li>
<li>
<p>使用矩阵乘法连接两个视频的 feature matrix</p>
<div class="arithmatex">\[
f_{(0)} = f'_p \circ f'_q
\]</div>
</li>
<li>
<p>对 <span class="arithmatex">\(f_{(0)}\)</span> 使用 堆叠的 [2D-Conv 层 + MaxPooling] 进行处理</p>
<blockquote>
<p>本文验证实验中使用了 2 层 2D-Conv</p>
</blockquote>
<p>记 i-th 层 2D-Conv 的输出为 <span class="arithmatex">\(f'_{(i)}\)</span>，<span class="arithmatex">\((w_{(i)}, b_{(i)})\)</span> 为该层的 ConvParams &amp; BiasVec</p>
<div class="arithmatex">\[
\begin{align*}
    f'_{(i)} &amp;= \text{ReLU}(w_{(i)} \otimes f_{(i-1)} + b_{(i)}) \\
    f_{(i)} &amp;= \text{MaxPool}(f'_{(i)})
\end{align*}
\]</div>
</li>
<li>
<p>使用 4Layers-MLP（多层感知机机）预测 relative score <span class="arithmatex">\(\Delta S\)</span>，Dense 层的节点数分别为 <code>[64, 32, 8, 1]</code></p>
<div class="arithmatex">\[
\Delta S = \text{MLP}(f_{(\text{last})})
\]</div>
</li>
</ol>
<h3 id="4-evaluation">4 Evaluation</h3>
<p>本文总共使用了 3 个 constraint 来同时提升对 <span class="arithmatex">\(\Delta S\)</span> &amp; <span class="arithmatex">\(\hat{S}\)</span> 预测的准确度：</p>
<ol>
<li>
<p>Loss for Basic-Regression</p>
<p>AQA 问题最本质的需求：获得更准确的 <span class="arithmatex">\(\hat{S}\)</span> -&gt; 最小化均方误差（两个视频分开算）</p>
<div class="arithmatex">\[
\mathcal{L}_{bs} = \frac{1}{2} \sum_{i=p,q}^N(\hat{S}_i - S)^2
\]</div>
</li>
<li>
<p>Loss for PCLN</p>
<p>同样的，我们需要更准确的 <span class="arithmatex">\(\Delta S\)</span></p>
<div class="arithmatex">\[
\mathcal{L}_{ds} = (\Delta S - |S_i - S_j|)^2
\]</div>
</li>
<li>
<p>Consistency between PCLN &amp; BasicRegression: 限制 <span class="arithmatex">\(\Delta S = |\hat{S}_i - \hat{S}_j|\)</span></p>
<div class="arithmatex">\[
\mathcal{L}_{rs} = (\Delta S - |\hat{S}_i - \hat{S}_j|)^2
\]</div>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">不同于先前的方法：在 test 阶段直接使用 Basic Regression 预测最终分数</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../Regression-Based/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Regression">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Regression
              </div>
            </div>
          </a>
        
        
          
          <a href="../Transformer/" class="md-footer__link md-footer__link--next" aria-label="下一页: Transformer">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Transformer
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023 SeaBee
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.expand", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
    
  </body>
</html>